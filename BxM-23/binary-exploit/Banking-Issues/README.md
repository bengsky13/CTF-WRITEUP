# Banking Issues

We're given a script

```python
import os
balances = [10, 20, 50, 16, 29, 52, 100000]
PERMS_ADMIN = {
   "MAX_INDEX": len(balances) - 1
}
PERMS_AGENT = {
   "MAX_INDEX": len(balances) - 2
}
def main():
   perms = PERMS_AGENT
   wallet = 0
   idx = int(input("Which account would you like to withdraw from? "))
   if idx > perms["MAX_INDEX"]:
       print("Unauthorized")
       return
   wallet += balances[idx]
   balances[idx] = 0
   print(f"You now have ${wallet} in your wallet.\n")
   if wallet >= 100000:
       print("Thanks for storing a lot of $$ at our bank.")
       print("You qualify for free wealth management services.")
       print(f"To access this service, please email {os.getenv('FLAG')}@bxmctf.bank.\n")
   print("Thank you for banking with BxMCTF Bank.")

if __name__ == "__main__":
 main()
```

# Analysis

We can see the program will take **input** as integer then take the **wallet** value at index of user **input**
our goal is to get value **100000**

But there are filter that must be satisfied

```python
PERMS_AGENT = {
   "MAX_INDEX": len(balances) - 2
}
if idx > perms["MAX_INDEX"]:
```

which mean our input cannot be 6 since since the len(balances) - 2 is 5

# Solution

Here what we can do is slice the **balances[idx]** by giving input **-1**
it will read the balances value of last index
like **balances[-1]**
since -1 > perms["MAX_INDEX"] it will return false
therefore we bypass the filter

```bash
Which account would you like to withdraw from? -1
You now have $100000 in your wallet.


Thanks for storing a lot of $$ at our bank.
You qualify for free wealth management services.
To access this service, please email ctf{0h_d34r_n3g4t1v3_1dx}@bxmctf.bank.


Thank you for banking with BxMCTF Bank.
```

**ctf{0h_d34r_n3g4t1v3_1dx}**
